---
title: 用Hexo搭建博客
categories:
  - 环境搭建
tags:
  - 用Hexo搭建博客
  - Hexo github
  - Hexo Coding
date: 2016-11-08 15:20:01
---

# 安装Hexo
Hexo是用node-js写的，hexo生成静态页面的速度要比较快，hexo是本地生成html再上传。

## 安装Node.js
官网下载对应平台安装包安装：https://nodejs.org  
详见：[Node.js开发环境搭建](http://leolan.top/2016/11/02/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-2016-11-02-Node-js%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/)

## 安装Hexo

```
npm install -g hexo-cli  #Mac下西安**sudo -i**切换到root权限。
hexo init blog           #blog文件夹要先建好，这一步自动生成网站。
cd blog
npm install              #安装依赖的插件。
hexo server              #运行服务
```

这时可以在浏览器打开网页。`hexo server`的简化命令为`hexo s`；指定端口：`-p xxxx`
和jekyll一样是通过修改**_config.yml**文件来配置站点信息的。（在Hexo中，根目录下的**_config.yml**文件是用来配置网站信息的；主题目录下的**_config.yml**文件是用来配置文章主题，页面等等的）

默认的目录结构如下：

```
├── .deploy       #执行hexo deploy命令部署到GitHub上的内容目录
├── public        #执行hexo generate命令，输出的静态网页内容目录
├── scaffolds     #layout模板文件目录，其中的md文件可以添加编辑
├── scripts       #扩展脚本目录，这里可以自定义一些javascript脚本
├── source        #文章源码目录，该目录下的markdown和html文件均会被hexo处理。404文件，CNAME文件等都应该放这里。
| ├── _drafts     #草稿文章
| └── _posts      #发布的文章
├── themes        #主题文件目录
├── _config.yml   #全局配置文件，大多数的设置都在这里
└── package.json  #应用程序数据，指明hexo的版本等信息。在push到github时提示*.json错误，删掉这个文件或删掉db.json就行。
```
---

# 配置优化、美化站点
Next官方设置说明：http://theme-next.iissnan.com/getting-started.html

## 主题部分
推荐Next主题，简单简洁，官网：http://theme-next.iissnan.com/
安装最新版：
```
cd your-hexo-site
git clone https://github.com/iissnan/hexo-theme-next themes/next```
在主题目录下可以看到next文件夹，修改**站点配置文件_config.yml**中的`theme: next`
`hexo clean && hexo s`就可以看到新主题生效啦！
接下来修改**主题配置文件_config.yml**，以下是我的配置。
```
# ---------------------------------------------------------------
# Site Information Settings
# ---------------------------------------------------------------

# Put your favicon.ico into `hexo-site/source/` directory.
favicon: /200.png    #头像

# Set default keywords (Use a comma to separate)
keywords: "Hexo, NexT"

# Set rss to false to disable feed link.
# Leave rss as empty to use site's feed link.
# Set rss to specific value if you have burned your feed already.
rss:

# Specify the date when the site was setup
#since: 2015

# Canonical, set a canonical link tag in your hexo, you could use it for your SEO of blog.
# See: https://support.google.com/webmasters/answer/139066
# Tips: Before you open this tag, remeber set up your URL in hexo _config.yml ( ex. url: http://yourdomain.com )
canonical: true

# ---------------------------------------------------------------
# Menu Settings
# ---------------------------------------------------------------

# When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -> archives)
menu:       #侧边栏显示的菜单，**：**后面对应相应的目录，里面**自建index.md**文件
  home: /
  categories: /categories
  tags: /tags
  archives: /archives
  about: /about
 # schedule: /schedule
  #commonweal: /404.html

# Enable/Disable menu icons.
# Icon Mapping:
#   Map a menu item to a specific FontAwesome icon name.
#   Key is the name of menu item and value is the name of FontAwsome icon. Key is case-senstive.
#   When an question mask icon presenting up means that the item has no mapping icon.
menu_icons:     #侧边栏菜单的图标
  enable: true
  #KeyMapsToMenuItemKey: NameOfTheIconFromFontAwesome
  home: home
  about: user
  categories: th
  schedule: calendar
  tags: tags
  archives: archive
  commonweal: heartbeat

# ---------------------------------------------------------------
# Scheme Settings
# ---------------------------------------------------------------

# Schemes 主题有3总样式，Muse，Mist，Pisces选择一种，其他注释掉
#scheme: Muse
#scheme: Mist
scheme: Pisces

# ---------------------------------------------------------------
# Font Settings
# - Find fonts on Google Fonts (https://www.google.com/fonts)
# - All fonts set here will have the following styles:
#     light, light italic, normal, normal intalic, bold, bold italic
# - Be aware that setting too much fonts will cause site running slowly
# - Introduce in 5.0.1
# ---------------------------------------------------------------
font:
  enable: true

  # Uri of fonts host. E.g. //fonts.googleapis.com (Default) 慢的话搜索fonts.googleapis.com即可找到替换地址
  host: fonts.css.network   #css字体加速

  # Global font settings used on <body> element.
  global:
    # external: true will load this font family from host.
    external: true
    family: Lato

  # Font settings for Headlines (h1, h2, h3, h4, h5, h6)
  # Fallback to `global` font settings.
  headings:
    external: true
    family:

  # Font settings for posts
  # Fallback to `global` font settings.
  posts:
    external: true
    family:

  # Font settings for Logo
  # Fallback to `global` font settings.
  # The `size` option use `px` as unit
  logo:
    external: true
    family:
    size:

  # Font settings for <code> and code blocks.
  codes:
    external: true
    family:
    size:

# ---------------------------------------------------------------
# Sidebar Settings
# ---------------------------------------------------------------

# Social Links
# Key is the link label showing to end users.
# Value is the target link (E.g. GitHub: https://github.com/iissnan)
#social:
#LinkLabel: Link

# Social Links Icons
# Icon Mapping:
#   Map a menu item to a specific FontAwesome icon name.
#   Key is the name of the item and value is the name of FontAwsome icon. Key is case-senstive.
#   When an globe mask icon presenting up means that the item has no mapping icon.
social_icons:
  enable: true
  # Icon Mappings.
  # KeyMapsToSocalItemKey: NameOfTheIconFromFontAwesome
  GitHub: github
  Twitter: twitter
  Weibo: weibo

# Sidebar Avatar
# in theme directory(source/images): /images/avatar.jpg
# in site  directory(source/uploads): /uploads/avatar.jpg
avatar: /images/avatar.jpg


# Table Of Contents in the Sidebar
toc:
  enable: true

  # Automatically add list number to toc.
  number: true

# Creative Commons 4.0 International License.
# http://creativecommons.org/
# Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero
#creative_commons: by-nc-sa
#creative_commons:

sidebar:
  # Sidebar Position, available value: left | right
  position: left
  #position: right

  # Sidebar Display, available value:
  #  - post    expand on posts automatically. Default.
  #  - always  expand for all pages automatically
  #  - hide    expand only when click on the sidebar toggle icon.
  #  - remove  Totally remove sidebar including sidebar toggler.
  #display: post
  display: always
  #display: hide
  #display: remove

# Blogrolls
#links_title: Links
#links_layout: block
#links_layout: inline
#links:
  #Title: http://example.com/

# ---------------------------------------------------------------
# Misc Theme Settings
# ---------------------------------------------------------------

# Custom Logo.
# !!Only available for Default Scheme currently.
# Options:
#   enabled: [true/false] - Replace with specific image
#   image: url-of-image   - Images's url
custom_logo:
  enabled: false
  image:


# Code Highlight theme  代码高亮主题
# Available value:
#    normal | night | night eighties | night blue | night bright
# https://github.com/chriskempson/tomorrow-theme
highlight_theme: night eighties


# Automatically scroll page to section which is under <!-- more --> mark.
scroll_to_more: true


# Automatically Excerpt. Not recommand.
# Please use <!-- more --> in the post to control excerpt accurately.
auto_excerpt:
  enable: true
  length: 150

# Wechat Subscriber
#wechat_subscriber:
  #enabled: true
  #qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg
  #description: ex. subscribe to my blog by scanning my public wechat account

# ---------------------------------------------------------------
# Third Party Services Settings
# ---------------------------------------------------------------

# MathJax Support   数学公式
mathjax:
  enable: false
  cdn: //cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML


# Swiftype Search API Key
#swiftype_key:

# Baidu Analytics ID
#baidu_analytics:

# Duoshuo ShortName
#duoshuo_shortname:

# Disqus
#disqus_shortname:

# Baidu Share
# Available value:
#    button | slide
# Warning: Baidu Share does not support https.
#baidushare:
##  type: button

# Share
#jiathis:
# Warning: JiaThis does not support https.
#add_this_id:

# Share
#duoshuo_share: true

# Google Webmaster tools verification setting
# See: https://www.google.com/webmasters/
#google_site_verification:


# Google Analytics
#google_analytics:

# CNZZ count
#cnzz_siteid:


# Make duoshuo show UA
# user_id must NOT be null when admin_enable is true!
# you can visit http://dev.duoshuo.com get duoshuo user id.
duoshuo_info:
  ua_enable: true
  admin_enable: false
  user_id: 0
  #admin_nickname: Author


# Facebook SDK Support.
# https://github.com/iissnan/hexo-theme-next/pull/410
facebook_sdk:
  enable: false
  app_id:       #<app_id>
  fb_admin:     #<user_id>
  like_button:  #true
  webmaster:    #true

# Facebook comments plugin
# This plugin depends on Facebook SDK.
# If facebook_sdk.enable is false, Facebook comments plugin is unavailable.
facebook_comments_plugin:
  enable: false
  num_of_posts: 10  # min posts num is 1
  width: 100%       # default width is 550px
  scheme: light     # default scheme is light (light or dark)

#网站访问量统计http://busuanzi.ibruce.info/   http://ibruce.info/2015/04/04/busuanzi/  其中id="busuanzi_container_site_*v">这句可以不要。 
# Show number of visitors to each article.   用leancloud做接口开启阅读计数功能
#文章阅读量统计：http://www.joryhe.com/2016-05-29-how_to_create_leancloud_read_Counter.html
# You can visit https://leancloud.cn get AppID and AppKey.
leancloud_visitors:
  enable: true
  app_id: zieuxKa4IjAP6VgxxvBe4vkj-gzGzoHsz
  app_key: MHGN54IEuofFNV1AROiRkEoG

# Show PV/UV of the website/page with busuanzi.
# Get more information on http://ibruce.info/2015/04/04/busuanzi/
busuanzi_count:     #不蒜子网站访问量统计
  # count values only if the other configs are false
  enable: false
  # custom uv span for the whole site
  site_uv: true
  site_uv_header: <i class="fa fa-user"></i>
  site_uv_footer:
  # custom pv span for the whole site
  site_pv: true
  site_pv_header: <i class="fa fa-eye"></i>
  site_pv_footer:
  # custom pv span for one page only
  page_pv: true
  page_pv_header: <i class="fa fa-file-o"></i>
  page_pv_footer:

# Tencent analytics ID
# tencent_analytics:

# Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO
baidu_push: true   #百度链接提交，提高搜索排名

# Google Calendar
# Share your recent schedule to others via calendar page
#
# API Documentation:
# https://developers.google.com/google-apps/calendar/v3/reference/events/list
calendar:
  enable: false
  calendar_id: <required>
  api_key: <required>
  orderBy: startTime
  offsetMax: 24
  offsetMin: 4
  timeZone:
  showDeleted: false
  singleEvents: true
  maxResults: 250

#! ---------------------------------------------------------------
#! DO NOT EDIT THE FOLLOWING SETTINGS
#! UNLESS YOU KNOW WHAT YOU ARE DOING
#! ---------------------------------------------------------------

# Motion
use_motion: true

# Fancybox
fancybox: true


# Script Vendors.
# Set a CDN address for the vendor you want to customize.
# For example
#    jquery: https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js
# Be aware that you should use the same version as internal ones to avoid potential problems.
# Please use the https protocol of CDN files when you enable https on your site.
vendors:
  # Internal path prefix. Please do not edit it.
  _internal: vendors

  # Internal version: 2.1.3
  jquery:

  # Internal version: 2.1.5
  # See: http://fancyapps.com/fancybox/
  fancybox:
  fancybox_css:

  # Internal version: 1.0.6
  # See: https://github.com/ftlabs/fastclick
  fastclick:

  # Internal version: 1.9.7
  # See: https://github.com/tuupola/jquery_lazyload
  lazyload:

  # Internal version: 1.2.1
  # See: http://VelocityJS.org
  velocity:

  # Internal version: 1.2.1
  # See: http://VelocityJS.org
  velocity_ui:

  # Internal version: 0.7.9
  # See: https://faisalman.github.io/ua-parser-js/
  ua_parser:

  # Internal version: 4.4.0
  # See: http://fontawesome.io/
  fontawesome:

# 多说热评文章功能
duoshuo_hotartical: true

# Assets
css: css
js: js
images: images

# Theme version
version: 5.0.2
```

## 配置文件设置
以下是我的配置文件：

```
# Hexo Configuration
## Docs: https://hexo.io/docs/configuration.html
## Source: https://github.com/hexojs/hexo/

# Site
title: Leo Lan的博客
subtitle:  有时候正是不报期望的人做出了人们不敢期望的事！
description: Better late than never
author: Leo Lan
language: zh-Hans
timezone: Asia/Shanghai

# URL
## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'
url: http://leolan.top
coding_url: http://leolan.top
root: /
permalink: :year/:month/:day/:title/
permalink_defaults:

# Directory
source_dir: source
public_dir: public
tag_dir: tags
archive_dir: archives
category_dir: categories
code_dir: downloads/code
i18n_dir: :lang
skip_render:

# Writing  官网：https://hexo.io/zh-cn/docs/writing.html
new_post_name: :year-:month-:day-:title.md # File name of new posts
default_layout: post
titlecase: false # Transform title into titlecase
external_link: true # Open external links in new tab
filename_case: 0
render_drafts: false
post_asset_folder: false
relative_link: false
future: true
highlight:
  enable: true
  line_number: true
  auto_detect: true
  tab_replace:

# Category & Tag
default_category: uncategorized
category_map:
tag_map:

# Date / Time format
## Hexo uses Moment.js to parse and display date
## You can customize the date format as defined in
## http://momentjs.com/docs/#/displaying/format/
date_format: YYYY-MM-DD
time_format: HH:mm:ss

# Pagination
## Set per_page to 0 to disable pagination
per_page: 15
pagination_dir: page

# Extensions
## Plugins: https://hexo.io/plugins/
## Themes: https://hexo.io/themes/
theme: next

# Deployment部署
## 官方文档Docs: https://hexo.io/docs/deployment.html   有部署到各种服务器的方法
## 参考：http://www.lxway.com/240950852.htm
#不管是github还是coding，type都填写git
#这里同事部署到Github和Coding上，在域名解析中设置国内IP访问Coding，国外IP访问Github。
#自动部署需要安装deployer-git插件：npm install hexo-deployer-git --save
deploy:
- type: git
  repo: git@git.coding.net:leolan/leolan.git,master  #注意你的分支是什么
- type: git
  repo: git@github.com:MyLeoLan/blog.git,master
#deploy:
#- type: git
#  repo:
#- type: heroku（另一种云平台）
#  repo:


# Disqus #Disqus评论系统
disqus_shortname: leolan


#plugins: #插件，例如生成 RSS 和站点地图的
#hexo-generator-sitemap
#- hexo-generator-baidu-sitemap
plugins:
  hexo-generator-feed
  hexo-generator-baidu-sitemap

sitemap:
  path: sitemap.xml    
baidusitemap:
  baidupath: baidusitemap.xml

# Social links  社交链接
social:
  GitHub: https://github.com/myleolan
  Coding: https://coding.net/u/leolan
  CSDN: http://blog.csdn.net/lan842632
  OSchina: https://my.oschina.net/leolan/blog
  #Twitter: https://twitter.com/lmintlcx
  #Zhihu: http://www.zhihu.com/people/lmintlcx
  #Douban: http://www.douban.com/people/lmintlcx
  #Weibo: http://weibo.com/u/3233729080

duoshuo_shortname: leolan
# 多说热评文章 true 或者 false
duoshuo_hotartical: true
# 多说分享服务
duoshuo_share: true
# 百度分享服务
baidushare: true


#打赏功能
reward_comment: 您的支持将鼓励我继续创作,非常感谢！
wechatpay: http://ofyfogrgx.bkt.clouddn.com/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE1.png
alipay: http://ofyfogrgx.bkt.clouddn.com/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE01.jpg

#站点建立时间
since: 2016

#百度分析
baidu_analytics: dc0e85252eeff3a87aa87f35d92a8d33

#本地搜索
search:
  path: search.xml
  field: post
  format: html
  limit: 10000
```

## 安装插件
hexo支持插件，可以直接通过命令行安装即可：`npm install **plugin-name** --save`
更新插件
`npm update`
卸载插件
`npm uninstall **plugin-name**`
下面推荐几个常用的插件：
feed插件:`npm install hexo-generator-feed --save`
站点地图:`npm install hexo-generator-sitemap --save`
百度站点地图:`npm install hexo-generator-baidu-sitemap --save`
文章字数统计：http://www.joryhe.com/2016-06-06-hexo_wordcount_setting_your_post.html

---

# 部署

```
cd your_site/
touch Staticfile  #创建静态文件标识，用于Github识别，名字必须是Staticfile
hexo clean   #清除以前生成的旧文件
hexo g       #生成新的站点文件
hexo d       #部署到Github上```
可参考：http://shomy.top/2016/03/03/hexo-in-coding-github/
部署完成打开网址就能看到效果了。

Hexo的部署只会把生成的文件上传到仓库中，本地的**设置，主题，*.md文件**等等都不会上传，换一台电脑就没法干活了，一旦删除，那基本上所有的努力都白费了，这里介绍2种备份方法：
* 1.新建一个仓库专门用来存放这些文件（最安全最方便的办法）
* 2.和发布的网站使用同一个仓库，master用来存放这些文件，新建分支来发布网站（注意pages服务绑定该分支，不要合并分支，一旦合并就全部混乱了）
两种方法都要在网站根目录设定好远程端仓库：`git add remote XXXX`
每次发布完网页，就顺手执行以下代码，把文档也同步到仓库中。
```
git add .
git commit -m "xxx"
git push
```

---

# 绑定域名
原理和博客绑定域名是一样的

* 1· 在你的项目下新建一个**CNAME**文件，注意没有后缀名。在里面添加你的域名，如我的就是** leolan.top**，然后推送**CNAME文件**到远程仓库。（方法二是直接在pages页上找到域名绑定设置，最好同时绑定如：**leolan.top**和**www.leolan.top**,少绑一个，没绑的那个打不开）
* 2· 到域名服务商那里增加你的CNAME记录。添加两条记录，@和www的主机记录，记录类型为CNAME，记录值为 `username.github.io. `，重要的是 io 后面还有一个原点（看官方帮助文档Coding的就不用加点），切记。
![](http://ofyfogrgx.bkt.clouddn.com//blog/%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9A.png)
过几分钟，刷新网页，就能直接用域名访问了，因为是在项目内建的**CNAME**文件，所以域名直接指向此项目文件夹，其他项目可以用其他域名设定。

---

# 参考资料
[Hexo](http://www.joryhe.com/tags/hexo/) 　　　 [Jekyll迁移到Hexo](http://www.ezlippi.com/blog/2016/02/jekyll-to-hexo.html)

---